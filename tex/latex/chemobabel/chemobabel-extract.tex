%! ----- For the purpose of extracting all codes of Open Babel figures -----
%%
%% This is file `chemobabel-extract.tex', bundled with `chemobabel.sty'.
%% 
%% Copyright 2014-2015 Acetaminophen (Hironobu Yamashita)
%%   GitHub: https://github.com/aminophen
%%   Blog: http://acetaminophen.hatenablog.com/
%%
%% Thanks: http://oku.edu.mie-u.ac.jp/tex/mod/forum/discuss.php?d=1411
%

\makeatletter

%% Define intermediate output file and load packages
\newwrite\ChemFigFile
\immediate\openout\ChemFigFile=ChemFigFile.tex\relax
\immediate\write\ChemFigFile{\string\documentclass{article}}
\immediate\write\ChemFigFile{\string\usepackage{graphicx}}
% for \smilesobabel and \chemobabel
\immediate\write\ChemFigFile{\string\usepackage{chemobabel}}
%%

%% Read and write
\immediate\write\ChemFigFile{\string\begin{document}}
\AtEndDocument{%
  \immediate\write\ChemFigFile{\string\end{document}}%
  \immediate\closeout\ChemFigFile%
}
\renewcommand\@@smilesobabel[3][scale=1]{%
  \endgroup
  \immediate\write\ChemFigFile{%
    \string\smilesobabel[#1]{#2}{#3}%
    \string\newpage}%
  [\smilesobabelGetName.pdf]%
  \addtocounter{smilesobabelCounter}{1}}
\renewcommand\chemobabel[3][scale=1]{%
  \immediate\write\ChemFigFile{%
    \string\chemobabel[#1]{#2}{#3}%
    \string\newpage}%
  [\chemobabelGetName.pdf]
  \addtocounter{chemobabelCounter}{1}}
%%

\makeatother

% ----- [EOF] -----
