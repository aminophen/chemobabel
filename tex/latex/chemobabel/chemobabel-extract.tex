%! ----- For the purpose of extracting all codes of Open Babel figures -----
%%
%% This is file `chemobabel-extract.tex', bundled with `chemobabel.sty'.
%% 
%% Copyright 2014-2016 Acetaminophen (Hironobu Yamashita)
%%   GitHub: https://github.com/aminophen
%%   Blog: http://acetaminophen.hatenablog.com/
%%
%% Thanks: http://oku.edu.mie-u.ac.jp/tex/mod/forum/discuss.php?d=1411
%

\NeedsTeXFormat{LaTeX2e}
\ProvidesFile{chemobabel-extract.tex}
  [2016/03/07 v0.9e Support file for chemobabel.sty]

%% Define intermediate output file and load packages
\newwrite\ChemFigFile
\immediate\openout\ChemFigFile=ChemFigFile.tex\relax
\immediate\write\ChemFigFile{\string\documentclass{article}}
\immediate\write\ChemFigFile{\string\usepackage{graphicx}}
% for \smilesobabel and \chemobabel
\immediate\write\ChemFigFile{\string\usepackage{chemobabel}}
%%

%% Read and write
\immediate\write\ChemFigFile{\string\begin{document}}
\AtEndDocument{%
  \immediate\write\ChemFigFile{\string\end{document}}%
  \immediate\closeout\ChemFigFile%
}
\renewcommand\smilesobabel{%
  \begingroup
  \let\do\@makeother
  \dospecials
  \catcode`\{=1
  \catcode`\}=2
  \@@smilesobabel
}
\newcommand\@@smilesobabel[3][scale=1]{%
  \endgroup
  \immediate\write\ChemFigFile{%
    \string\smilesobabel[#1]{#2}{#3}%
    \string\newpage}%
  [\smilesob@belGetName.\chemob@belimgExt]%
  \addtocounter{smilesob@belCounter}{1}}
\renewcommand\chemobabel{%
  \begingroup
  \let\do\@makeother
  \dospecials
  \catcode`\{=1
  \catcode`\}=2
  \@@chemobabel
}
\newcommand\@@chemobabel[3][scale=1]{%
  \endgroup
  \immediate\write\ChemFigFile{%
    \string\chemobabel[#1]{#2}{#3}%
    \string\newpage}%
  [\chemob@belGetName.\chemob@belimgExt]%
  \addtocounter{chemob@belCounter}{1}}
%%

% ----- [EOF] -----
